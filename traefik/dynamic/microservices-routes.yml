---
# =============================================================================
# üåê TRAEFIK MINIMAL ROUTING CONFIGURATION - INFRAESTRUTURA FASE
# =============================================================================
# Configura√ß√£o m√≠nima para fase de infraestrutura
# Apenas servi√ßos internos e ping para evitar 404s
# =============================================================================

http:
  routers:
    # ====================================================================
    # üìä PING/HEALTH INTERNO - EVITA 404s
    # ====================================================================
    api-ping:
      rule: "PathPrefix(`/ping`) || PathPrefix(`/api/ping`)"
      service: "api@internal"
      entrypoints:
        - web
        - websecure

    # Fallback para evitar 404s em desenvolvimento
    fallback-router:
      rule: "HostRegexp(`{host:.+}`)"
      service: "fallback-service"
      entrypoints:
        - web
        - websecure
      priority: 1

  services:
    # ==========================================================================
    # üìä SERVI√áO FALLBACK PARA EVITAR 404s - USANDO TRAEFIK INTERNO
    # ==========================================================================
    fallback-service:
      loadBalancer:
        servers:
          - url: "http://conexao-traefik_traefik:8080"

# =============================================================================
# Esta configura√ß√£o evita 404s durante a fase de infraestrutura
# =============================================================================
