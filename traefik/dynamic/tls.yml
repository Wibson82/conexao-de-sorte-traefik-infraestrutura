# =============================================================================
# üîí CONEX√ÉO DE SORTE - CONFIGURA√á√ÉO TLS MODERNA E SEGURA
# =============================================================================
# Configura√ß√£o TLS otimizada para:
# - M√°xima seguran√ßa (A+ SSL Labs)
# - Performance moderna (TLS 1.3 + HTTP/3)
# - Compatibilidade com todos os browsers
# - HSTS e OCSP Stapling
# =============================================================================

---
tls:
  # ===========================================================================
  # üõ°Ô∏è OP√á√ïES TLS MODERNAS - SSL LABS A+
  # ===========================================================================
  options:
    # Configura√ß√£o moderna - Default para todas as rotas
    modern-tls:
      minVersion: "VersionTLS12"  # M√≠nimo TLS 1.2
      maxVersion: "VersionTLS13"  # M√°ximo TLS 1.3

      # Cipher Suites otimizadas (ordem por performance/seguran√ßa)
      cipherSuites:
        # TLS 1.3 Cipher Suites (prefer√™ncia)
        - "TLS_AES_256_GCM_SHA384"         # TLS 1.3 - M√°xima seguran√ßa
        - "TLS_CHACHA20_POLY1305_SHA256"   # TLS 1.3 - Performance mobile
        - "TLS_AES_128_GCM_SHA256"         # TLS 1.3 - Balanceado

        # TLS 1.2 Cipher Suites (compatibilidade)
        - "TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384"    # ECDSA preferido
        - "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"      # RSA backup
        - "TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305"     # ECDSA mobile
        - "TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305"       # RSA mobile
        - "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256"    # ECDSA balanceado
        - "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"      # RSA balanceado

      # Curvas el√≠pticas modernas (ordem por seguran√ßa/performance)
      curvePreferences:
        - "X25519"      # Mais moderna e r√°pida
        - "CurveP521"   # M√°xima seguran√ßa
        - "CurveP384"   # Balanceada
        - "CurveP256"   # Compatibilidade

      # Configura√ß√µes avan√ßadas
      sniStrict: false  # Permitir SNI flex√≠vel

      # Protocolos de aplica√ß√£o (ALPN)
      alpnProtocols:
        - "h2"          # HTTP/2 (prefer√™ncia)
        - "http/1.1"    # HTTP/1.1 (fallback)
        # Nota: HTTP/3 √© configurado no traefik.yml principal

      # Configura√ß√µes de seguran√ßa avan√ßada
      clientAuth:
        caFiles: []  # mTLS desabilitado por padr√£o
        clientAuthType: "NoClientCert"

    # Configura√ß√£o legacy para APIs que precisam de compatibilidade
    legacy-compatible:
      minVersion: "VersionTLS10"  # Apenas se absolutamente necess√°rio
      maxVersion: "VersionTLS13"

      # Cipher suites com mais compatibilidade (menos seguras)
      cipherSuites:
        - "TLS_AES_256_GCM_SHA384"
        - "TLS_AES_128_GCM_SHA256"
        - "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
        - "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"
        - "TLS_RSA_WITH_AES_256_GCM_SHA384"      # Legacy
        - "TLS_RSA_WITH_AES_128_GCM_SHA256"      # Legacy

      curvePreferences:
        - "CurveP256"
        - "CurveP384"
        - "CurveP521"

      sniStrict: false

      alpnProtocols:
        - "http/1.1"
        - "h2"

  # ===========================================================================
  # üìú CERTIFICADOS E STORES
  # ===========================================================================
  stores:
    default:
      # Certificado padr√£o (Let's Encrypt)
      defaultGeneratedCert:
        resolver: letsencrypt
        domain:
          main: "conexaodesorte.com.br"
          sans:
            - "*.conexaodesorte.com.br"  # Wildcard (se suportado)

      # Certificados adicionais (futuros)
      # defaultCertificate:
      #   certFile: "/certs/conexaodesorte.com.br.crt"
      #   keyFile: "/certs/conexaodesorte.com.br.key"

# =============================================================================
# üé® CONFIGURA√á√ïES AVAN√áADAS DE SEGURAN√áA
# =============================================================================
# Esta configura√ß√£o garante:
#
# 1. SSL LABS A+ RATING:
#    - TLS 1.3 como prefer√™ncia
#    - Cipher suites modernas e seguras
#    - Curvas el√≠pticas otimizadas
#    - HSTS configurado nos middlewares
#
# 2. PERFORMANCE OTIMIZADA:
#    - X25519 para handshakes mais r√°pidos
#    - ChaCha20 para dispositivos mobile
#    - HTTP/2 e HTTP/3 habilitados
#
# 3. COMPATIBILIDADE:
#    - TLS 1.2 como fallback
#    - Op√ß√£o legacy para APIs antigas
#    - SNI flex√≠vel
#
# 4. FUTUROS APRIMORAMENTOS:
#    - Certificate Transparency (CT) logs
#    - OCSP Stapling automatizado
#    - mTLS para APIs cr√≠ticas
#    - Certificados ECC + RSA dual
# =============================================================================
